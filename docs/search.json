[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Crime in NY",
    "section": "",
    "text": "1 Introduction\n\nWhile deciding on a topic for our project, we received several emails from the Columbia Department of Safety about an armed robbery near the Columbia campus. This prompted us to get interested in Crime data in and around NYC – in particular; it made us question the safety around Columbia and in NYC specifically. We found several exciting and detailed datasets about crime in NYC and quickly focused on NYC incident-level shootings data in the past ten years to see in how much “danger” we are:\n\n\n\n\n\n(This plot is just for \"motivational\" purposes. In the main body of the text we shall focus on a different dataset.)\nIndeed, it seems like there is a relative “hotspot” of shooting incidences near Columbia. The hotspot is mostly several blocks from campus, but it is insightful to us to know which areas to avoid.\nThis first broad analysis took us down a rabbit hole of crime and crime-related datasets. We eventually decided to focus on NY State data, as it provides a less localized, more widespread, and comprehensive view of crimes over the years. Furthermore, NY State seems more representative of drastically different styles of living, which – we believe – allows for a more contrasting picture. This topic is attractive due to its insights into crime trends over time and across different areas.\nOur primary dataset encompasses detailed crime statistics for each agency in New York State’s counties spanning from 1990 to 2022. This extensive temporal range of approximately three decades enables a thorough examination of the evolution of crime patterns within each New York county. Moreover, it facilitates a comparative analysis of crime statistics between New York City and the entire state.\nIn our exploration, we aim to address various questions related to crime dynamics, patterns, and potential influencing factors. For example, we will delve into the examination of how socioeconomic factors, law enforcement strategies, and demographic shifts may have impacted crime rates over the years. Additionally, we are interested in investigating the influence of the COVID-19 pandemic on crime statistics, both in terms of overall rates and the types of crimes reported.\nTo enhance the depth of our analysis, we have supplemented our primary dataset with additional data providing population numbers for each county in New York State for the time period covered in our crime dataset. This supplementary information is crucial as it allows us to calculate and compare crime rates adjusted for population size. By doing so, we aim to provide a more nuanced understanding of crime trends and ensure that our analysis considers variations in population density across different counties.\nUltimately, our research endeavors not only contribute to a comprehensive analysis of public safety trends but also serve as a valuable resource for policymakers and the public. The insights derived from this study can aid in developing informed strategies to understand and address various crime-related issues within the state of New York."
  },
  {
    "objectID": "data.html#technical-description",
    "href": "data.html#technical-description",
    "title": "2  Data",
    "section": "2.1 Technical Description",
    "text": "2.1 Technical Description\nThe dataset on Index Crimes by County and Agency in New York, is collected by the New York State Division of Criminal Justice Services, which obtains crime reports from more than 500 New York State police and sheriff’s departments. The data is formatted in a tabular structure, with columns specifying details like county, agency, year, region, and various crime categories. So, the dataset includes geographic information (county and agency), temporal information (year), and crime categories and contains roughly 22 thousand rows and 15 columns.\nThe reporting system gathers data on seven “index offenses”, commonly used to assess the overall volume of crime. These encompass violent crimes such as murder/non-negligent manslaughter, forcible rape, robbery, and aggravated assault, as well as property crimes like burglary, larceny, and motor vehicle theft.\nThe data has been collected since January 1990. The frequency of updates is on an annual basis, but the individual law enforcement agencies report their total crimes to the New York State Division of Criminal Justice Services monthly. Issues with the data include inconsistencies in reporting methods among different agencies, variations in the definition of crimes, or potential underreporting. We should be cautious about these nuances when interpreting trends or comparing regions and periods. Indeed, police agencies might need help with reporting, which could hinder accurate or comprehensive data submission. The figures reflect solely the crimes reported to the police and do not encompass the total number of crimes.\nWe carefully check that the data is consistent, i.e., that the various accumulations performed within the dataset are correct. We find some inconsistencies in the County Total accumulation in Albany from 1990-1997 and Nassau County in 1990. We discuss this further in the analysis of the missing values.\nSince comparing crime numbers among the different counties only really makes sense if we normalize by population, we supplement our primary dataset, Index Crimes by County and Agency in New York, with an official population dataset of the counties in NY state. The New York State Department of Labor curated the population dataset. It has been updated yearly since 2014 and contains the (estimated) population of each County in NY state by year since 1970.\nThe dataset contains the FIPS (“Federal Information Processing Standards”) code of each NY state county, together with the name of the county (“Geography”), the year, and its population estimate. Finally, it includes a column, “Program Type,” detailing how the population number was estimated. The estimations are interpolations or extrapolations of the 10-year census data of NY State. Before 2010, the estimations were based on interpolations since for each year, in between the actual census data, both previous and following census numbers were known. However, after 2010, the data was kept as “point-in-time,” and therefore, the estimations were based solely on extrapolating the previous census numbers. It is essential to keep the data point-in-time, as changing the numbers in hindsight would lead to issues with models that use extrapolated data numbers.\nThe more detailed methodology of the “intercensal estimation” is detailed here and here. Essentially, for intercensal estimates, they combine the data from the two censuses with death, birth, migration, and immigration data to provide an estimate. In contrast, for postcensal forecasts, they use the previous census data and the same external sources to provide an estimate.\nWe shall briefly investigate the efficacies of these estimates and notice that the extrapolation is comparatively worse than the intercensal estimated data, but that for our purposes the estimation errors are negligible."
  },
  {
    "objectID": "data.html#research-plan",
    "href": "data.html#research-plan",
    "title": "2  Data",
    "section": "2.2 Research plan",
    "text": "2.2 Research plan\nTo answer research questions related to crime trends and influencing factors, our primary dataset offers a rich source of information.\n\n2.2.1 Temporal aspects\nGiven the extensive span of thorough reporting within our primary dataset, we can conduct longitudinal studies, examine crime rates over multiple years, and identify particular trends and patterns. We can do this for all of NY State or county specific and compare trends between counties. For instance, it would be exciting to see whether vastly contrasting trends exist among the different counties.\nAnalyzing the data throughout the years enables assessing whether crime has increased, decreased, or remained stable. This could provide insights into the effectiveness of law enforcement strategies, changes in societal conditions, or potential impacts of specific events such as the COVID-19 pandemic. This could give a more nuanced understanding of the factors influencing crime dynamics.\n\n\n2.2.2 Geographic aspects\nA geographic analysis is also possible since our primary dataset contains location-specific information. Indeed, the dataset includes information on crimes reported by different counties and agencies. This allows us to compare crime rates across regions, potentially revealing interesting spatial patterns or clusters. For instance, we can compare the evolution of crime between NYC and NY state. Understanding variations in crime rates helps tailor interventions to specific areas.\nGiven the spatial information within the dataset, further supplementing it with demographic information would be interesting. This might involve exploring correlations between crime rates, socioeconomic factors, population density, or demographic shifts over time. Furthermore, if there are contrasting law enforcement strategies among different counties (or even agencies), we could potentially assess the impact of those strategies by analyzing changes in crime rates following the implementation of specific policies or practices. This might allow us to identify variations in reporting practices, law enforcement effectiveness, or community characteristics that may influence crime rates.\n\n\n2.2.3 Crime specific aspects\nFinally, the dataset is categorized into specific crime types. This allows us to analyze trends in each category, helping identify areas of concern and inform targeted interventions for potential hotspots in particular crimes.\nIt is crucial to acknowledge potential limitations such as data inconsistencies, reporting biases, and missing information, which may affect the robustness of conclusions drawn from the analysis."
  },
  {
    "objectID": "data.html#missing-value-analysis-and-other-inconsistencies",
    "href": "data.html#missing-value-analysis-and-other-inconsistencies",
    "title": "2  Data",
    "section": "2.3 Missing value analysis and other inconsistencies",
    "text": "2.3 Missing value analysis and other inconsistencies\nWe shall now investigate our two datasets for missing values and inconsistencies and discuss if our findings will impact our research and results.\n\n2.3.1 NY State crime dataset\nWe start by investigating the NY State crime dataset.\nThe data is well-sourced and only contains NA values for the “Months Reported” column. In particular, upon further investigation, it turns out that a lot of the NA values appear in the accumulated “County Total” rows because as soon as an Agency does not indicate the number of months they reported, this will lead to an NA value in the accumulation.\nBelow, we have summarized the percentage of NA values in the Months Collected column per county.\n\n\nCode\nna_cols &lt;- colSums(is.na(crime_ny))\nna_rows &lt;- crime_ny[is.na(crime_ny[, names(na_cols[na_cols&gt;0])]), ]\n\nna_rows_cnt &lt;- na_rows %&gt;% group_by(County) %&gt;% summarise(Count = n())\ncrime_ny_cnt &lt;- crime_ny %&gt;% group_by(County) %&gt;% summarise(Count = n())\nna_rows_cnt$pct &lt;- na_rows_cnt$Count/crime_ny_cnt$Count\n\nna_rows_cnt &lt;- na_rows_cnt[order(na_rows_cnt$pct, decreasing = TRUE), ]\n\nggplot(na_rows_cnt, \n       aes(x = reorder(County, -pct), \n           y = pct * 100)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Percentage of Missing \\\"Months Collected\\\" Values by County\",\n       x = \"County\", y = \"Missing Percentage\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1)) +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))\n\n\n\n\n\nWe notice that the five counties with the most missing value percentages in the “Months Collected” column are the ones where we do not have Agency-level data, but only “County Total” data. We believe these numbers were aggregated from different datasets, which may have varying degrees of accuracy concerning their monthly collected information.\nWhile we are not specifically interested in the “months collected” column, we need to remember that if data was consistentlycollected for strictly less than 12 months per year, there might be a skew in the data. To get an estimate of how often we are dealing with data from less than 12 months (for the NA cases), we look at the respective fraction within the non-NA values.\n\n\nCode\nless_12 &lt;- crime_ny[(crime_ny$Months.Reported &lt; 12) & !is.na(crime_ny$Months.Reported), ]\nless_12_cnt &lt;- less_12 %&gt;% \n  group_by(County) %&gt;% \n  summarise(Count = n())\n\nno_na_crime_ny_cnt &lt;- crime_ny[!is.na(crime_ny$Months.Reported), ] %&gt;% \n  group_by(County) %&gt;% \n  summarise(Count = n())\nmerged_data &lt;- merge(less_12_cnt, no_na_crime_ny_cnt, by = \"County\", all.x = TRUE)\nmerged_data$pct &lt;- merged_data$Count.x/merged_data$Count.y\n\nmerged_data &lt;- merged_data[order(merged_data$pct, decreasing = TRUE), ]\n\nggplot(merged_data, \n       aes(x = reorder(County, -pct), \n           y = 100*pct)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Percentage of &lt;12 vs 12 \\\"Months Collected\\\" by County\",\n       x = \"County\", \n       y = \"Percentage of &lt;12 vs 12 Months Collected\") +\n  scale_y_continuous(labels = scales::percent_format(scale = 1)) +\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))\n\n\n\n\n\nWe observe that the data collected with less than 12 months compared against the data collected with precisely 12 months is relatively negligible. Based on this, we believe the missing NA values are primarily due to data collection negligence rather than drastic variations of the number of months data was reported/collected.\nApart from the missing values, we wanted to make sure that the data aggregation was performed consistently within the dataset. We first check that the columns sum to their respective total columns for each row and find that there is no inconsistency there:\n\n\nCode\n# Check that other entries sum to Index.Total:\n\n# First check Property Total + Violent Total == Index Total\ncheck_result &lt;- crime_ny %&gt;%\n  group_by(Year, County, Agency) %&gt;%\n  summarise(Sum_Other_Entries = Property.Total + Violent.Total, .groups = \"drop\") %&gt;%\n  left_join(crime_ny, by = c(\"Year\", \"County\", \"Agency\")) %&gt;%\n  mutate(Check = ifelse(Sum_Other_Entries == Index.Total, \"Pass\", \"Fail\"))\ncat(nrow(check_result[check_result$Check!='Pass',]), ' rows with mismatch of Property Total + Violent Total == Index Total.\\n')\n\n\n0  rows with mismatch of Property Total + Violent Total == Index Total.\n\n\nCode\n# First check Murder + Rape + Robbery + Aggravated Assault == Violent Total\ncheck_result &lt;- crime_ny %&gt;%\n  group_by(Year, County, Agency) %&gt;%\n  summarise(Sum_Other_Entries = Murder + Rape + Robbery + Aggravated.Assault, .groups = \"drop\") %&gt;%\n  left_join(crime_ny, by = c(\"Year\", \"County\", \"Agency\")) %&gt;%\n  mutate(Check = ifelse(Sum_Other_Entries == Violent.Total, \"Pass\", \"Fail\"))\ncat(nrow(check_result[check_result$Check!='Pass',]), ' rows with mismatch of Murder + Rape + Robbery + Aggravated Assault == Violent Total. \\n')\n\n\n0  rows with mismatch of Murder + Rape + Robbery + Aggravated Assault == Violent Total. \n\n\nCode\n# First check Burglary + Larceny + Motor.Vehicle.Theft == Property Total\ncheck_result &lt;- crime_ny %&gt;%\n  group_by(Year, County, Agency) %&gt;%\n  summarise(Sum_Other_Entries = Burglary + Larceny + Motor.Vehicle.Theft, .groups = \"drop\") %&gt;%\n  left_join(crime_ny, by = c(\"Year\", \"County\", \"Agency\")) %&gt;%\n  mutate(Check = ifelse(Sum_Other_Entries == Property.Total, \"Pass\", \"Fail\"))\ncat(nrow(check_result[check_result$Check!='Pass',]), ' rows with mismatch of Burglary + Larceny + Motor.Vehicle.Theft == Property Total \\n')\n\n\n0  rows with mismatch of Burglary + Larceny + Motor.Vehicle.Theft == Property Total \n\n\nFinally, we would also like to check whether there is a mismatch between the County Total accumulation and the individual (by-agency) values. For the cases in which we have by-agency data, there is a minor mismatch between the summed data and the County total data in Nassau in 1990 and Albany between 1990 and 1997. It may be due to data from a missing agency, but we could not verify this explicitly.\n\n\nCode\n# Find mismatch in County Total vs per-police station:\ncounty_total_entries &lt;- crime_ny %&gt;%\n  filter(Agency == \"County Total\")\n\ncolumns_to_sum &lt;- c(\n  \"Index.Total\", \"Violent.Total\", \"Murder\", \"Rape\",\n  \"Robbery\", \"Aggravated.Assault\", \"Property.Total\",\n  \"Burglary\", \"Larceny\", \"Motor.Vehicle.Theft\"\n)\n\ncrime_ny_not_ct &lt;- crime_ny[crime_ny$Agency!='County Total',] \n\nsummed_data &lt;- crime_ny_not_ct %&gt;%\n  group_by(Year, County) %&gt;%\n  summarise(across(all_of(columns_to_sum), sum), .groups = \"drop\")\n\ncomparison_result &lt;- left_join(summed_data, \n                               county_total_entries, \n                               by = c(\"Year\", \"County\"))\n\ncomparison_result &lt;- comparison_result %&gt;%\n  mutate(\n    Check_Index.Total = ifelse(Index.Total.x == Index.Total.y, \"Match\", \"Mismatch\"),\n    Check_Violent.Total = ifelse(Violent.Total.x == Violent.Total.y, \"Match\", \"Mismatch\"),\n    Check_Murder = ifelse(Murder.x == Murder.y, \"Match\", \"Mismatch\"),\n    Check_Rape = ifelse(Rape.x == Rape.y, \"Match\", \"Mismatch\"),\n    Check_Robbery = ifelse(Robbery.x == Robbery.y, \"Match\", \"Mismatch\"),\n    Check_Aggravated.Assault = ifelse(Aggravated.Assault.x == Aggravated.Assault.y, \"Match\", \"Mismatch\"),\n    Check_Property.Total = ifelse(Property.Total.x == Property.Total.y, \"Match\", \"Mismatch\"),\n    Check_Burglary = ifelse(Burglary.x == Burglary.y, \"Match\", \"Mismatch\"),\n    Check_Larceny = ifelse(Larceny.x == Larceny.y, \"Match\", \"Mismatch\"),\n    Check_Motor.Vehicle.Theft = ifelse(Motor.Vehicle.Theft.x == Motor.Vehicle.Theft.y, \"Match\", \"Mismatch\")\n  )\n\ncheck_columns &lt;- paste0(\"Check_\", columns_to_sum)\nmismatch_rows &lt;- comparison_result %&gt;%\n  rowwise() %&gt;%\n  filter(any(c_across(all_of(check_columns)) == \"Mismatch\"))\n\nmismatch_rows_long &lt;- tidyr::gather(mismatch_rows, key = \"Variable\", value = \"Check_Value\", all_of(check_columns))\nmismatch_rows_long &lt;- mismatch_rows_long[mismatch_rows_long$Check_Value =='Mismatch',] \n\nvariables &lt;- unique(mismatch_rows_long$Variable)\nfor (variable in variables) {\n  variable_name &lt;- gsub(\"^Check_\", \"\", variable)\n  xx &lt;- mismatch_rows_long[mismatch_rows_long$Variable == variable, ]\n  mismatch_rows_long[mismatch_rows_long$Variable == variable,'diff'] &lt;-\n    xx[, paste0(variable_name, \".y\")] - xx[, paste0(variable_name, \".x\")]\n}\n\nmismatch_rows_long_indextot &lt;- mismatch_rows_long[mismatch_rows_long$Variable == 'Check_Index.Total',]\n\nmismatch_rows_long_indextot_long &lt;- tidyr::pivot_longer(mismatch_rows_long_indextot, \n                                                       cols = c(\"Index.Total.x\", \"Index.Total.y\"), \n                                                       names_to = \"Category\", \n                                                       values_to = \"Value\")\n\nmismatch_rows_long_indextot$Year &lt;- factor(mismatch_rows_long_indextot$Year)\n\n\nmismatch_rows_long_indextot_pl &lt;- pivot_longer(data = mismatch_rows_long_indextot,\n             cols = c(Index.Total.x,Index.Total.y))\n\nmismatch_rows_long_indextot_pl &lt;- mismatch_rows_long_indextot_pl %&gt;%\n  mutate(name = ifelse(name == \"Index.Total.x\", \"Summed Up\", name),\n         name = ifelse(name == \"Index.Total.y\", \"County Total\", name))\nmismatch_rows_long_indextot_pl &lt;- rename(mismatch_rows_long_indextot_pl, Type = name)\n\nggplot(mismatch_rows_long_indextot_pl, \n       aes(x = interaction(Year, County), \n               y = value, \n               fill = Type)) +\n  geom_bar(position = \"dodge\", \n           stat = \"identity\", \n           width = 0.7) +\n  labs(title = \"Difference between \\\"County Total\\\" values and summed up values\", \n       x = \"Year + County\", \n       y = \"Total Number of Crimes\") +\n  scale_fill_manual(values = c(\"County Total\" = \"blue\", \n                               \"Summed Up\" = \"lightblue\")) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\nIn the plot above we compare the discrepancy in the total crime number for each inconsistency. We observe that the inconsistency is very minor and will not affect our analysis below.\n\n\n2.3.2 NY State population dataset\nWe now focus on the population dataset.\nWe first plot the percentage of the available (i.e., non-NA, non-empty, non-missing) data:\n\n\nCode\npop_ny &lt;- read.csv('data/Annual_Population_Estimates_for_New_York_State_and_Counties__Beginning_1970.csv')\npop_ny$FIPS.Code &lt;- substr(pop_ny$FIPS.Code, 3, nchar(pop_ny$FIPS.Code))\n\nmissing_percentage &lt;- sapply(pop_ny, \n                             function(x) sum(is.na(x) | x == \"\") / length(x) * 100)\nresult &lt;- data.frame(Column = names(missing_percentage), \n                     MissingPercentage = missing_percentage)\nresult &lt;- result[order(-result$MissingPercentage), ]\n\nggplot(result, \n       aes(x = Column, \n           y = 100 - MissingPercentage)) +\n  geom_bar(stat = \"identity\", \n           fill = \"lightblue\") +\n  geom_text(aes(label = sprintf(\"%.1f%%\", 100 - MissingPercentage)),\n            vjust = 1.5, size = 5) +\n  labs(title = \"Percentage of Available Data in Each Column\",\n       x = \"Column\",\n       y = \"Available Percentage\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\nCode\n#library(redav)\n#\n#plot_missing(result, percent = T)\n\n\nIt turns out that we are dealing with a well-cured dataset without any missing values.\nAs mentioned above, the population datasets contain population estimates for the years within/outside of census data. We want to visualize how well these estimations perform and whether there are significant discrepancies with the “actual” population numbers. Here, we take the census numbers as the ground truth, which is certainly sufficient for our purposes but may not be wise for more detailed studies.\nTo do so, we focus on the population numbers for the whole state as a representative. Furthermore, we restrict to data after 1990, as that is the period of interest for us:\n\n\nCode\npop_ny_full_state &lt;- pop_ny[(pop_ny$Geography == 'New York State') & (pop_ny$Year &gt;= 1990), ]\npop_ny_full_state &lt;- rename(pop_ny_full_state, Type = Program.Type)\n\nggplot(pop_ny_full_state, \n                        aes(x = Year, \n                            y = Population/1000000, \n                            fill = Type)) +\n  geom_col(position = \"dodge\", \n           width = 0.9) + \n  labs(title = \"Population (estimate) per Year\", \n       x = \"Year\", \n       y = \"Population (in Millions)\") +\n  scale_fill_manual(values = c(\"Census Base Population\" = \"blue\", \n                              \"Postcensal Population Estimate\" = \"red\",\n                              'Intercensal Population Estimate' = 'orange')) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n\n\n\n\nNotice that we have estimates even for the census years (1990, 2000, 2010, and 2020); Their respective bars are split into two (and of different colors). The intercensal population estimates are in line with the census data (which makes sense), while there is a small jump between the 2019 estimate and the 2020 census data. As we remarked above, this dataset was created in 2014 and kept as point-in-time. Therefore, the forecast will be postcensal for anything after 2010.\nThe estimates will undoubtedly be good enough for our purposes. We are interested in the ratio crime/population size, and therefore will divide a relatively small number by a large number. Hence, minor errors in the population estimates will not affect any conclusions we draw in the following.\n\n\nCode\n# \n# ggplot(mismatch_rows_long_indextot, \n#        aes(x = interaction(Year, County)), \n#            order = (Year)) +\n#   geom_bar(aes(y = Index.Total.y, \n#                fill = \"County Total values\"), \n#            stat = \"identity\", \n#            position = \"dodge\",\n#            alpha=0.5) +\n#   geom_bar(aes(y = Index.Total.x, \n#                fill = \"Sum of Reported Values by Agencies\"), \n#            stat = \"identity\", \n#            position = \"dodge\",\n#             alpha=0.5) +\n#   labs(title = \"Difference between \\\"County Total\\\" values and summed up values\", \n#        x = \"Year + County\", \n#        y = \"Total Number of Crimes\") +\n#   scale_fill_manual(values = c(\"County Total values\" = \"red\", \n#                                \"Sum of Reported Values by Agencies\" = \"blue\")) +\n#   theme_minimal() +\n#   theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n#\n# \n# census_years &lt;- unique(pop_ny_full_state[pop_ny_full_state$Program.Type == 'Census Base Population', ]$Year)\n# \n# pop_ny_full_state_cens_yrs &lt;- subset(pop_ny_full_state, pop_ny_full_state$Year %in% census_years)\n# \n# pop_ny_full_state_cens_yrs_wide &lt;- pivot_wider(pop_ny_full_state_cens_yrs, \n#                        names_from = Program.Type, \n#                        values_from = Population)\n# colnames(pop_ny_full_state_cens_yrs_wide)\n# \n# names(pop_ny_full_state_cens_yrs_wide)\n# \n# ggplot(pop_ny_full_state_cens_yrs_wide, aes(x = Year)) +\n#   geom_point(aes(y = `Census Base Population`, color = \"Census Base Population\"), \n#              position = position_dodge(width = 0.4)) +\n#   geom_point(aes(y = `Intercensal Population Estimate`, color = \"Intercensal Estimate\"), \n#              position = position_dodge(width = 0.2)) +\n#   geom_point(aes(y = `Postcensal Population Estimate`, color = \"Postcensal Estimate\"), \n#              position = position_dodge(width = -0.2)) +\n#   labs(title = \"A\", x = \"B\", y = \"C\") +\n#   scale_color_manual(values = c(\"Census Base Population\" = \"blue\", \n#                                 \"Intercensal Estimate\" = \"orange\",\n#                                 \"Postcensal Estimate\" = \"red\"),\n#                      name = \"Legend Title\") +\n#   theme_minimal() +\n#   theme(axis.text.x = element_text(angle = 45, hjust = 1))"
  },
  {
    "objectID": "results.html#overall-crime-numbers-in-ny-state-and-the-impact-of-covid-10",
    "href": "results.html#overall-crime-numbers-in-ny-state-and-the-impact-of-covid-10",
    "title": "3  Results",
    "section": "3.1 Overall crime numbers in NY State and the impact of COVID-10",
    "text": "3.1 Overall crime numbers in NY State and the impact of COVID-10\n\n\nCode\ncrime_ny$Year &lt;- as.numeric(crime_ny$Year)\ncrime_ny_filtered &lt;- crime_ny %&gt;%\n  mutate(Year_Period = cut(Year, \n                           breaks = seq(1985, max(Year) + 5, \n                           by = 5), \n                           labels = FALSE),\n         Year_Period_Label = paste0(floor((Year - 1985) / 5) * 5 + 1985,\n                                    \"-\",\n                                    floor((Year - 1985) / 5) * 5 + 1989)\n         )\n\ncrime_ny_filtered_county_tot &lt;- crime_ny_filtered[crime_ny_filtered$Agency=='County Total',]\n\ntot_yearly &lt;- crime_ny_filtered_county_tot %&gt;%\n  group_by(Year) %&gt;%\n  summarise(\n    Total_Index = sum(Index.Total)\n  ) %&gt;%\n  ungroup()\n\nggplot(tot_yearly, aes(x = Year, \n                      y = Total_Index)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_viridis_c() +\n  theme_minimal() +\n  labs(title = \"Total number of crimes in NY State by year\",\n       x = \"Year\",\n       y = \"Total number of recorded crimes\")\n\n\n\n\n\nWe see an interesting uptick after 2021 potentially due to COVID-19. Worth investigating more!\n\n\nCode\ncrime_ny_with_fips_and_pop$crime_pct &lt;- crime_ny_with_fips_and_pop$Index.Total/crime_ny_with_fips_and_pop$Population\n\ntot_yearly &lt;- crime_ny_with_fips_and_pop %&gt;%\n  group_by(Year) %&gt;%\n  summarise(\n    Total_crime = sum(Index.Total)\n  ) %&gt;%\n  ungroup()\n\ntot_yearly &lt;- merge(tot_yearly, pop_ny[pop_ny$Geography == 'New York State', ], by.x = \"Year\", by.y = \"Year\", all.x = TRUE)\n\ntot_yearly$pct &lt;- tot_yearly$Total_crime/tot_yearly$Population\n\nggplot(tot_yearly, aes(x = Year, \n                      y = pct)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_viridis_c() +\n  theme_minimal() +\n  labs(title = \"Crimes per population of crimes in NY State by year\",\n       x = \"Year\",\n       y = \"Recorded crimes per population\")\n\n\n\n\n\n\n3.1.1 Increase in crimes per population per county\n\n\nCode\nimpact_of_covid &lt;- crime_ny_with_fips_and_pop\nimpact_of_covid$crime_pct &lt;- impact_of_covid$Index.Total/impact_of_covid$Population\n\ncrime_increase &lt;- impact_of_covid[impact_of_covid$Year &gt; 2020, ] %&gt;%\n  group_by(County) %&gt;%\n  summarize(increase = last(crime_pct) - first(crime_pct)) %&gt;%\n  filter(!is.na(increase))\n\ntop_counties &lt;- crime_increase %&gt;% top_n(62, wt = increase)\n\nselected_data &lt;- impact_of_covid %&gt;%\n  filter(County %in% top_counties$County)\n\ncounty_order &lt;- names(sort(tapply(selected_data$crime_pct, selected_data$County, max), decreasing = TRUE))\nselected_data$County &lt;- factor(selected_data$County, levels = county_order)\n\nmy_palette &lt;- viridis_pal()(length(unique(selected_data$County)))\n\nggplot(selected_data, aes(x = Year, y = crime_pct, color = County)) +\n  geom_line() +\n  scale_color_manual(values = my_palette) +\n  labs(title = \"Crime/population per Year for Counties with worst increase post-covid\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  theme_minimal()\n\n\n\n\n\n\n\nCode\nimpact_of_covid &lt;- crime_ny_with_fips_and_pop\nimpact_of_covid$crime_pct &lt;- impact_of_covid$Index.Total/impact_of_covid$Population\nimpact_of_covid &lt;- impact_of_covid[impact_of_covid$Year &gt; 2015, ]\n\ncrime_increase &lt;- impact_of_covid[impact_of_covid$Year &gt; 2020, ] %&gt;%\n  group_by(County) %&gt;%\n  summarize(increase = last(crime_pct) - first(crime_pct)) %&gt;%\n  filter(!is.na(increase))\n\ntop_counties &lt;- crime_increase %&gt;% top_n(10, wt = increase)\n\nselected_data &lt;- impact_of_covid %&gt;%\n  filter(County %in% top_counties$County)\n\ncounty_order &lt;- names(sort(tapply(selected_data$crime_pct, selected_data$County, max), decreasing = TRUE))\nselected_data$County &lt;- factor(selected_data$County, levels = county_order)\n\nmy_palette &lt;- viridis_pal()(length(unique(selected_data$County)))\n\nggplot(selected_data, aes(x = Year, y = crime_pct, color = County)) +\n  geom_line() +\n  scale_color_manual(values = my_palette) +\n  labs(title = \"Crime/population per Year for Counties with worst increase post-covid\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  theme_minimal()\n\n\n\n\n\n\n\nCode\nlibrary(viridis)\n\nimpact_of_covid &lt;- crime_ny_with_fips_and_pop\nimpact_of_covid$crime_pct &lt;- impact_of_covid$Index.Total/impact_of_covid$Population\nimpact_of_covid &lt;- impact_of_covid[impact_of_covid$Year &gt; 2015, ]\n\nbottom_counties &lt;- crime_increase %&gt;% top_n(10, wt = -increase)\n\nselected_data &lt;- impact_of_covid %&gt;%\n  filter((County %in% bottom_counties$County) | County %in% top_counties$County) \n\ncounty_order &lt;- names(sort(tapply(selected_data$crime_pct, selected_data$County, max), decreasing = TRUE))\nselected_data$County &lt;- factor(selected_data$County, levels = county_order)\n\nmy_palette &lt;- viridis_pal()(length(unique(selected_data$County)))\n\nggplot(selected_data, aes(x = Year, y = crime_pct, color = County)) +\n  geom_line() +\n  scale_color_manual(values = my_palette) +\n  labs(title = \"Crime/population per Year for Counties with least increase post-covid\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  theme_minimal()\n\n\n\n\n\nDraw on map where each of these counties lie and see if there is a geographical connection.\n\n\nCode\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(viridis)\nlibrary(magick)\n\n\nLinking to ImageMagick 6.9.12.93\nEnabled features: cairo, fontconfig, freetype, heic, lcms, pango, raw, rsvg, webp\nDisabled features: fftw, ghostscript, x11\n\n\nCode\nimpact_of_covid &lt;- crime_ny_with_fips_and_pop\nimpact_of_covid$crime_pct &lt;- impact_of_covid$Index.Total/impact_of_covid$Population\n\ncrime_pct_increase &lt;- impact_of_covid[impact_of_covid$Year &gt;= 2020, ] %&gt;%\n  group_by(County) %&gt;%\n  summarize(increase = (last(crime_pct) - first(crime_pct))/first(crime_pct)) %&gt;%\n  filter(!is.na(increase))\n\nny_state_boundaries &lt;- st_read(\"../tl_2016_36_cousub/tl_2016_36_cousub.shp\")\n\n\nReading layer `tl_2016_36_cousub' from data source \n  `/Users/martinfluder/tl_2016_36_cousub/tl_2016_36_cousub.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1023 features and 18 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -79.76259 ymin: 40.4774 xmax: -71.77749 ymax: 45.01586\nGeodetic CRS:  NAD83\n\n\nCode\nny_state_boundaries &lt;- st_transform(ny_state_boundaries, crs = 4326)\nny_state_boundaries$COUNTYFP &lt;- as.character(ny_state_boundaries$COUNTYFP)\n\nimpact_of_covid_region &lt;- impact_of_covid %&gt;% select(FIPS, County)\nimpact_of_covid_region &lt;- impact_of_covid_region[!duplicated(impact_of_covid_region), ]\nimpact_of_covid_region &lt;- merge(impact_of_covid_region, crime_pct_increase, by.x = \"County\", by.y = \"County\")\nimpact_of_covid_region$FIPS &lt;- as.character(impact_of_covid_region$FIPS)\n\ncrime_ny_covid_merged &lt;- merge(ny_state_boundaries, impact_of_covid_region, by.x = \"COUNTYFP\", by.y = \"FIPS\")\n\ncrime_ny_covid_sf &lt;- st_as_sf(crime_ny_covid_merged, coords = c(\"Longitude\", \"Latitude\"), crs = 4326)\n\ndesired_crs &lt;- 4326\nlibrary(viridis)\n\nggplot(crime_ny_covid_sf, aes(fill = increase)) +\n  geom_sf(color = \"black\") +\n  scale_fill_viridis_c(option = \"magma\", direction = -1) +\n  theme_minimal() +\n  labs(title = \"pct increase 2020 -&gt; 2022\",\n       fill = \"increase\")\n\n\n\n\n\nSchuyler seems to have a 90% increase since covid:\n\n\nCode\nselected_data &lt;- impact_of_covid[impact_of_covid$County == 'Schuyler', ]\nselected_data &lt;- selected_data[selected_data$Year &gt; 2015, ]\n\nggplot(selected_data, aes(x = Year, y = crime_pct, color = County)) +\n  geom_line() +\n  scale_color_manual(values = my_palette) +\n  labs(title = \"Crime/population per Year for Counties with least increase post-covid\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  theme_minimal()\n\n\n\n\n\n\n\nCode\nimpact_of_covid &lt;- crime_ny_with_fips_and_pop\nimpact_of_covid$crime_pct &lt;- impact_of_covid$Index.Total/impact_of_covid$Population\n\ncrime_pct_increase &lt;- impact_of_covid[impact_of_covid$Year &gt;= 2020, ] %&gt;%\n  group_by(County) %&gt;%\n  summarize(increase = (last(crime_pct) - first(crime_pct))) %&gt;%\n  filter(!is.na(increase))\n\nny_state_boundaries &lt;- st_read(\"../tl_2016_36_cousub/tl_2016_36_cousub.shp\")\n\n\nReading layer `tl_2016_36_cousub' from data source \n  `/Users/martinfluder/tl_2016_36_cousub/tl_2016_36_cousub.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1023 features and 18 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -79.76259 ymin: 40.4774 xmax: -71.77749 ymax: 45.01586\nGeodetic CRS:  NAD83\n\n\nCode\nny_state_boundaries &lt;- st_transform(ny_state_boundaries, crs = 4326)\nny_state_boundaries$COUNTYFP &lt;- as.character(ny_state_boundaries$COUNTYFP)\n\nimpact_of_covid_region &lt;- impact_of_covid %&gt;% select(FIPS, County)\nimpact_of_covid_region &lt;- impact_of_covid_region[!duplicated(impact_of_covid_region), ]\nimpact_of_covid_region &lt;- merge(impact_of_covid_region, crime_pct_increase, by.x = \"County\", by.y = \"County\")\nimpact_of_covid_region$FIPS &lt;- as.character(impact_of_covid_region$FIPS)\n\ncrime_ny_covid_merged &lt;- merge(ny_state_boundaries, impact_of_covid_region, by.x = \"COUNTYFP\", by.y = \"FIPS\")\n\ncrime_ny_covid_sf &lt;- st_as_sf(crime_ny_covid_merged, coords = c(\"Longitude\", \"Latitude\"), crs = 4326)\n\ndesired_crs &lt;- 4326\nlibrary(viridis)\n\nggplot(crime_ny_covid_sf, aes(fill = increase)) +\n  geom_sf(color = \"black\") +\n  scale_fill_viridis_c(option = \"magma\", direction = -1) +\n  theme_minimal() +\n  labs(title = \"absolute increase 2020 -&gt; 2022\",\n       fill = \"increase\")"
  },
  {
    "objectID": "results.html#crime-rates-per-population-size-per-counties-for-5-year-periods",
    "href": "results.html#crime-rates-per-population-size-per-counties-for-5-year-periods",
    "title": "3  Results",
    "section": "3.2 Crime rates (per population size) per counties for 5 year periods",
    "text": "3.2 Crime rates (per population size) per counties for 5 year periods\n\n\nCode\ncombined_data &lt;- crime_ny_filtered_county_tot %&gt;%\n  group_by(Year_Period_Label, County) %&gt;%\n  summarise(\n    Total_Index = sum(Index.Total),\n  ) %&gt;%\n  ungroup()\n\n\n`summarise()` has grouped output by 'Year_Period_Label'. You can override using\nthe `.groups` argument.\n\n\nCode\ntop_5_counts &lt;- combined_data %&gt;%\n  group_by(Year_Period_Label) %&gt;%\n  top_n(5, wt = Total_Index) %&gt;%\n  ungroup()\n\ntop_5_counts$County &lt;- fct_reorder(top_5_counts$County, \n                                   top_5_counts$Total_Index, \n                                   .desc = TRUE)\n\ntop_5_counts &lt;- top_5_counts %&gt;%\n  group_by(Year_Period_Label) %&gt;%\n  mutate(Rank = -rank(Total_Index))\n\ntop_5_counts$County &lt;- fct_reorder(top_5_counts$County, top_5_counts$Rank)\n\n\nggplot(top_5_counts, aes(x = County, \n                         y = Total_Index)) +\n  geom_bar(stat = \"identity\") +\n  facet_wrap(~Year_Period_Label, \n             scales = \"free_x\", #\"free_x\",\n             nrow = 5) +\n  scale_fill_viridis_c() +\n  theme_minimal() +\n  labs(title = \"Index.Total by County\",\n       x = \"County\",\n       y = \"Index.Total\")"
  },
  {
    "objectID": "results.html#overall-crime-numbers-in-ny-state-and-the-impact-of-covid-10-1",
    "href": "results.html#overall-crime-numbers-in-ny-state-and-the-impact-of-covid-10-1",
    "title": "3  Results",
    "section": "3.3 Overall crime numbers in NY State and the impact of COVID-10",
    "text": "3.3 Overall crime numbers in NY State and the impact of COVID-10"
  },
  {
    "objectID": "results.html#impact-of-stop-and-frisk-on-crime-statistics-under-bloomberg",
    "href": "results.html#impact-of-stop-and-frisk-on-crime-statistics-under-bloomberg",
    "title": "3  Results",
    "section": "3.4 Impact of stop-and-frisk on crime statistics under Bloomberg",
    "text": "3.4 Impact of stop-and-frisk on crime statistics under Bloomberg\n\n\nCode\nNYC &lt;- crime_ny_with_fips_and_pop[crime_ny_with_fips_and_pop$Region == 'New York City', ]\ncolumns_to_plot &lt;- c(\"Murder\", \"Rape\", \"Robbery\", \"Aggravated.Assault\", \"Burglary\", \"Larceny\", \"Motor.Vehicle.Theft\")\nNYC_long &lt;- tidyr::gather(NYC, key = \"Variable\", value = \"Value\", columns_to_plot)\n\n\nWarning: Using an external vector in selections was deprecated in tidyselect 1.1.0.\nℹ Please use `all_of()` or `any_of()` instead.\n  # Was:\n  data %&gt;% select(columns_to_plot)\n\n  # Now:\n  data %&gt;% select(all_of(columns_to_plot))\n\nSee &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.\n\n\nCode\nNYC_long_summarized &lt;- NYC_long %&gt;%\n  group_by(Year, Variable) %&gt;%\n  summarise(Sum_Value = sum(Value, na.rm = TRUE),\n            Population = sum(Population)) %&gt;%\n  ungroup()\n\n\n`summarise()` has grouped output by 'Year'. You can override using the\n`.groups` argument.\n\n\nCode\n# ggplot(NYC, aes(x = Year)) +\n#   geom_point(aes(y = Murder), color = \"red\", linetype = \"solid\", size = 1) +\n#   geom_point(aes(y = Rape), color = \"blue\", linetype = \"solid\", size = 1) +\n#   geom_point(aes(y = Robbery), color = \"green\", linetype = \"solid\", size = 1) +\n#   labs(title = \"Time Series Plot for Individual Columns in NYC County\",\n#        x = \"Year\",\n#        y = \"Value\") +\n#   theme_minimal()\n\nggplot(NYC_long_summarized, aes(x = Year, y = Sum_Value/Population, color = Variable)) +\n  geom_line() +\n  scale_color_manual(values = my_palette) +\n  labs(title = \"Crime/population per Year for Counties with least increase post-covid\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  theme_minimal()\n\n\n\n\n\n\n\nCode\nnon_NYC &lt;- crime_ny_with_fips_and_pop[crime_ny_with_fips_and_pop$Region != 'New York City', ]\ncolumns_to_plot &lt;- c(\"Murder\", \"Rape\", \"Robbery\", \"Aggravated.Assault\", \"Burglary\", \"Larceny\", \"Motor.Vehicle.Theft\")\nnon_NYC_long &lt;- tidyr::gather(non_NYC, key = \"Variable\", value = \"Value\", columns_to_plot)\n\nnon_NYC_long_summarized &lt;- non_NYC_long %&gt;%\n  group_by(Year, Variable) %&gt;%\n  summarise(Sum_Value = sum(Value, na.rm = TRUE),\n            Population = sum(Population)) %&gt;%\n  ungroup()\n\n\n`summarise()` has grouped output by 'Year'. You can override using the\n`.groups` argument.\n\n\nCode\n# ggplot(NYC, aes(x = Year)) +\n#   geom_point(aes(y = Murder), color = \"red\", linetype = \"solid\", size = 1) +\n#   geom_point(aes(y = Rape), color = \"blue\", linetype = \"solid\", size = 1) +\n#   geom_point(aes(y = Robbery), color = \"green\", linetype = \"solid\", size = 1) +\n#   labs(title = \"Time Series Plot for Individual Columns in NYC County\",\n#        x = \"Year\",\n#        y = \"Value\") +\n#   theme_minimal()\n# ggplot(non_NYC_long_summarized, aes(x = Year, y = Sum_Value/Population, color = Variable)) +\n#   geom_line() +\n#   scale_color_manual(values = my_palette) +\n#   labs(title = \"Crime/population per Year for Counties with least increase post-covid\",\n#        x = \"Year\",\n#        y = \"Crime/population\") +\n#   theme_minimal()\n\ncombined_NYC &lt;- rbind(\n  mutate(NYC_long_summarized, Location = \"NYC\"),\n  mutate(non_NYC_long_summarized, Location = \"Non-NYC\")\n)\n\nggplot(combined_NYC, \n       aes(x = Year, \n           y = Sum_Value/Population, \n           color = Location, \n           group = Location)) +\n  geom_line() +\n  labs(title = \"NYC vs Non-NYC\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  scale_color_manual(values = c(\"NYC\" = \"blue\", \"Non-NYC\" = \"red\")) +\n  theme_minimal() +\n  facet_wrap(~Variable, scales = \"free_y\")\n\n\n\n\n\n\n\nCode\ncombined_NYC_bloomb &lt;- combined_NYC[(combined_NYC$Year &gt; 1999) & (combined_NYC$Year &lt; 2015), ]\n\nggplot(combined_NYC_bloomb, \n       aes(x = Year, \n           y = Sum_Value/Population, \n           color = Location, \n           group = Location)) +\n  geom_line() +\n  labs(title = \"NYC vs Non-NYC\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  scale_color_manual(values = c(\"NYC\" = \"blue\", \n                                \"Non-NYC\" = \"red\")) +\n  theme_minimal() +\n  facet_wrap(~Variable, scales = \"free_y\")\n\n\n\n\n\nDuring 2002 - 2012, NYC imposed stop-and-frisk, we compare NYC crime reports (for 7 major crime stats) vs non-NYC. If the stop and frisk had any effect, we expect NYC crime stats to decrease stronger than non-NYC. Logic: stop and frisk -&gt; “create more safety” -&gt; less crime overall.\nThere are various flaws with our analysis: Do not consider other effects, etc.\nTo compare set starting point the same:\n\n\nCode\ncombined_NYC_bloomb &lt;- combined_NYC %&gt;%\n  filter(Year &gt; 1999 & Year &lt; 2015) %&gt;%\n  group_by(Variable, Location) %&gt;%\n  mutate(adjusted_value = Sum_Value/Population - first(Sum_Value/Population))\n\nggplot(combined_NYC_bloomb, aes(x = Year, y = adjusted_value, color = Location, group = Location)) +\n  geom_line() +\n  labs(title = \"Adjusted NYC vs Non-NYC\",\n       x = \"Year\",\n       y = \"Adjusted\") +\n  scale_color_manual(values = c(\"NYC\" = \"blue\", \"Non-NYC\" = \"red\")) +\n  theme_minimal() +\n  facet_wrap(~Variable, scales = \"free_y\")\n\n\n\n\n\n\n\nCode\ncombined_NYC_bloomb &lt;- combined_NYC %&gt;%\n  filter(Year &gt; 1980 & Year &lt;=2002) %&gt;%\n  group_by(Variable, Location)\ncombined_NYC_bloomb1 &lt;- combined_NYC_bloomb %&gt;%\n  group_by(Year, Location) %&gt;%\n  summarise(Sum_Value = sum(Sum_Value, na.rm = TRUE),\n            Population = sum(Population)) %&gt;%\n  ungroup()\n\n\n`summarise()` has grouped output by 'Year'. You can override using the\n`.groups` argument.\n\n\nCode\ncombined_NYC_bloomb1 &lt;- combined_NYC_bloomb1 %&gt;%\n  group_by(Location) %&gt;% \n  mutate(adjusted_value = Sum_Value/Population - first(Sum_Value/Population))\n\ncombined_NYC_bloomb &lt;- combined_NYC %&gt;%\n  filter(Year &gt;= 2002 & Year &lt;=2012) %&gt;%\n  group_by(Variable, Location)\ncombined_NYC_bloomb2 &lt;- combined_NYC_bloomb %&gt;%\n  group_by(Year, Location) %&gt;%\n  summarise(Sum_Value = sum(Sum_Value, na.rm = TRUE),\n            Population = sum(Population)) %&gt;%\n  ungroup()\n\n\n`summarise()` has grouped output by 'Year'. You can override using the\n`.groups` argument.\n\n\nCode\ncombined_NYC_bloomb2 &lt;- combined_NYC_bloomb2 %&gt;%\n  group_by(Location) %&gt;% \n  mutate(adjusted_value = Sum_Value/Population - first(Sum_Value/Population))\n\ncombined_NYC_bloomb &lt;- combined_NYC %&gt;%\n  filter(Year &gt;= 2012 & Year &lt;=2042) %&gt;%\n  group_by(Variable, Location)\ncombined_NYC_bloomb3 &lt;- combined_NYC_bloomb %&gt;%\n  group_by(Year, Location) %&gt;%\n  summarise(Sum_Value = sum(Sum_Value, na.rm = TRUE),\n            Population = sum(Population)) %&gt;%\n  ungroup()\n\n\n`summarise()` has grouped output by 'Year'. You can override using the\n`.groups` argument.\n\n\nCode\ncombined_NYC_bloomb3 &lt;- combined_NYC_bloomb3 %&gt;%\n  group_by(Location) %&gt;% \n  mutate(adjusted_value = Sum_Value/Population - first(Sum_Value/Population))\n\nggplot(combined_NYC_bloomb1, aes(x = Year, y = adjusted_value, color = Location, group = Location)) +\n  geom_line() +\n  labs(title = \"NYC vs Non-NYC\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  scale_color_manual(values = c(\"NYC\" = \"blue\", \"Non-NYC\" = \"red\")) +\n  theme_minimal()\n\n\n\n\n\nCode\nggplot(combined_NYC_bloomb2, aes(x = Year, y = adjusted_value, color = Location, group = Location)) +\n  geom_line() +\n  labs(title = \"NYC vs Non-NYC\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  scale_color_manual(values = c(\"NYC\" = \"blue\", \"Non-NYC\" = \"red\")) +\n  theme_minimal()\n\n\n\n\n\nCode\nggplot(combined_NYC_bloomb3, aes(x = Year, y = adjusted_value, color = Location, group = Location)) +\n  geom_line() +\n  labs(title = \"NYC vs Non-NYC\",\n       x = \"Year\",\n       y = \"Crime/population\") +\n  scale_color_manual(values = c(\"NYC\" = \"blue\", \"Non-NYC\" = \"red\")) +\n  theme_minimal()\n\n\n\n\n\n\n\nCode\nggplot(combined_NYC, aes(x=Year, y=Sum_Value, fill=Variable)) + \n    geom_area()+\n  labs(title = \"Stacked Area Plot of Crime Types\",\n       x = \"Year\",\n       y = \"Crime\")+\n  theme_minimal()+\n  facet_wrap(~Location, ncol = 1)"
  }
]